function Canvas(e){var h=e,c=false;if(typeof e==="string"){h=document.querySelector(e);if(!h){h=document.body}}var c=false;if(h instanceof HTMLCanvasElement){c=h}else{c=h.querySelector("canvas");if(!c){c=document.createElement("canvas");var g=parseInt(window.getComputedStyle(h,null).getPropertyValue("padding-left")),f=parseInt(window.getComputedStyle(h,null).getPropertyValue("padding-right")),d=parseInt(window.getComputedStyle(h,null).getPropertyValue("padding-top")),a=parseInt(window.getComputedStyle(h,null).getPropertyValue("padding-bottom")),b=h.clientWidth-g-f,i=h.clientHeight-d-a;h.appendChild(c);c.width=b;c.height=i}}this.bounds=c.getBoundingClientRect();this.width=c.width;this.height=c.height;this._timer=false;this._ctx=c.getContext("2d");this._elemDr=[];this.add=function(j){if(j instanceof Drawable){this._elemDr.push(j)}return this};this.rem=function(k){if(k instanceof Drawable&&this._elemDr.length){for(var j=this._elemDr.length-1;j>=0;j--){if(this._elemDr[j]==k){this._elemDr.splice(j,1);return true}}}return false};this.draw=function(){this._ctx.clearRect(0,0,this.width,this.height);if(this._elemDr.length){for(var j=0,k=this._elemDr.length;j<k;j++){this._elemDr[j].draw(this._ctx)}}};this.clear=function(){this._elemDr=[];this._elemDr.length=0;this._ctx.clearRect(0,0,this.width,this.height)};this.animate=function(j){j=undefined==j?1000/60:j;clearInterval(this._timer);if(j){this._timer=setInterval(this.draw.bind(this),j)}};this._onClick=function(l){var k=l.clientX-this.bounds.left,n=l.clientY-this.bounds.top;for(var j in this._elemDr){var m=this._elemDr[j];if(m.vision(k,n)&&typeof m.onClick==="function"){m.onClick(k,n);m.draw(this._ctx)}}};c.addEventListener("mouseup",this._onClick.bind(this),false);c.addEventListener("touchend",this._onClick.bind(this),false)}var Drawable=function(){this.x=0;this.y=0;this.w=0;this.h=0;this.label=false;this.fontName="Verdana";this.fontColor="#ffffff";this.fontSize=14;this.width=function(a){if(undefined==a){return this.w}else{this.w=a}return this};this.height=function(a){if(undefined==a){return this.h}else{this.h=a}return this};this.size=function(){if(0==arguments.length){return{w:this.w,h:this.h}}else{var a=arguments[0],b=arguments.length>1?arguments[1]:arguments[0];this.w=a;this.h=b}return this};this.position=function(a,b){if(undefined==a){return{x:this.x,y:this.y}}else{if(undefined!=a&&undefined!=b){this.x=a;this.y=b}}return this};this.vision=function(o,n){var h={x:o,y:n};var g=function g(p,m){return{x:(m.x-p.x),y:(m.y-p.y)}};var d=function(p,m){return p.x*m.x+p.y*m.y};var c={A:{x:this.x,y:this.y},B:{x:this.x+this.w,y:this.y},C:{x:this.x+this.w,y:this.y+this.h},D:{x:this.x,y:this.y+this.h}};var i=g(c.A,c.B);var b=g(c.A,h);var e=g(c.B,c.C);var l=g(c.B,h);var j=d(i,b);var a=d(i,i);var f=d(e,l);var k=d(e,e);return 0<=j&&j<=a&&0<=f&&f<=k}};Drawable.prototype.draw=function(c){if(this.label){c.textBaseline="top";c.font=this.fontSize+"px "+this.fontName;c.fillStyle=this.fontColor;c.textBaseline="middle";c.textAlign="center";var b=[].concat(this.label),g=c.measureText("M").width,a=this.x+this.w/2,h=this.y+g/2,f=(b.length*g);h+=this.h/2-f/2;for(var d=0,e=b.length;d<e;d++){c.fillText(b[d],a,h);h+=g}}};function Line(){Drawable.call(this);this.fillStyle="#f0f0f0";this.lineWidth=1;this.draw=function(a){a.save();Drawable.prototype.draw.call(this,a);a.beginPath();a.fillStyle=this.fillStyle;a.lineWidth=this.lineWidth;a.moveTo(this.x,this.y);a.lineTo(this.w,this.h);a.stroke();a.restore()}}Line.prototype=Object.create(Drawable.prototype);Line.prototype.constructor=Line;function Rectangle(){Drawable.call(this);this.fillStyle="#f0f0f0";this.draw=function(a){a.save();Drawable.prototype.draw.call(this,a);a.fillStyle=this.fillStyle;a.fillRect(this.x,this.y,this.w,this.h);a.restore()}}Rectangle.prototype=Object.create(Drawable.prototype);Rectangle.prototype.constructor=Rectangle;function Layout(b,a){this.maxWidth=b;this.maxHeight=a;this.padding=10;this.flowLeft=function(e){var d=1,g=1;for(var c in e){var f=e[c];if(f instanceof Drawable){f.position(d,g);d+=f.width()+this.padding;if(d+f.width()>=this.maxWidth){g+=f.height()+this.padding;d=1}}}}};