function Canvas(g){this.isDom=function(i){try{return i instanceof HTMLElement}catch(h){return(typeof i==="object")&&(i.nodeType===1)&&(typeof i.style==="object")&&(typeof i.ownerDocument==="object")}};var d=undefined!=g&&this.isDom(g)?g:document.body,f=parseInt(window.getComputedStyle(d,null).getPropertyValue("padding-left")),b=parseInt(window.getComputedStyle(d,null).getPropertyValue("padding-right")),a=parseInt(window.getComputedStyle(d,null).getPropertyValue("padding-top")),e=parseInt(window.getComputedStyle(d,null).getPropertyValue("padding-bottom"));width=d.clientWidth-f-b,height=d.clientHeight-a-e;var c=d.getElementsByTagName("canvas");if(c.length==0){c=d.appendChild(document.createElement("canvas"));c.width=width;c.height=height}else{c=c[0]}this.bounds=c.getBoundingClientRect();this.width=width;this.height=height;this._ctx=c.getContext("2d");this.drawables=[];this.addDrawable=function(h){if(h instanceof Drawable){this.drawables.push(h)}};this.delDrawable=function(j){if(j instanceof Drawable&&this.drawables.length){for(var h=this.drawables.length-1;h>=0;h--){if(this.drawables[h]==j){this.drawables.splice(h,1);return true}}}return false};this.draw=function(){if(this.drawables.length){this._ctx.clearRect(0,0,this.width,this.height);for(var h=0,j=this.drawables.length;h<j;h++){this.drawables[h].draw(this._ctx)}}};this.clear=function(){this.drawables=[];this._ctx.clearRect(0,0,this.width,this.height)};this._onClick=function(j){var i=j.clientX-this.bounds.left,l=j.clientY-this.bounds.top;for(var h in this.drawables){var k=this.drawables[h];if(k.vision(i,l)&&typeof k.onClick==="function"){k.onClick(i,l);k.draw(this._ctx)}}};c.addEventListener("mouseup",this._onClick.bind(this),false);c.addEventListener("touchend",this._onClick.bind(this),false)}var Drawable=function(){this.x=0;this.y=0;this.w=0;this.h=0;this.label=false;this.fontName="Verdana";this.fontColor="#ffffff";this.fontSize=14;this.width=function(a){if(undefined==a){return this.w}else{this.w=a}return this};this.height=function(a){if(undefined==a){return this.h}else{this.h=a}return this};this.size=function(a,b){if(undefined==a){return{w:this.w,h:this.h}}else{if(a&&b){this.w=a;this.h=b}}return this};this.position=function(a,b){if(undefined==a){return{x:this.x,y:this.y}}else{if(undefined!=a&&undefined!=b){this.x=a;this.y=b}}return this};this.vision=function(o,n){var h={x:o,y:n};var g=function g(p,m){return{x:(m.x-p.x),y:(m.y-p.y)}};var d=function(p,m){return p.x*m.x+p.y*m.y};var c={A:{x:this.x,y:this.y},B:{x:this.x+this.w,y:this.y},C:{x:this.x+this.w,y:this.y+this.h},D:{x:this.x,y:this.y+this.h}};var i=g(c.A,c.B);var b=g(c.A,h);var e=g(c.B,c.C);var l=g(c.B,h);var j=d(i,b);var a=d(i,i);var f=d(e,l);var k=d(e,e);return 0<=j&&j<=a&&0<=f&&f<=k}};Drawable.draw=function(c){if(this.label){c.textBaseline="top";c.font=this.fontSize+"px "+this.fontName;c.fillStyle=this.fontColor;c.textBaseline="middle";c.textAlign="center";var b=[].concat(this.label),f=c.measureText("M").width,a=this.x+this.w/2,g=this.y+f/2,e=(b.length*f);g+=this.h/2-e/2;for(var d in b){c.fillText(b[d],a,g);g+=f}}};function Rectangle(){Drawable.call(this);this.fillStyle="#f0f0f0";this.draw=function(a){a.save();a.fillStyle=this.fillStyle;a.fillRect(this.x,this.y,this.w,this.h);Drawable.draw.call(this,a);a.restore()}}Rectangle.prototype=Object.create(Drawable.prototype);Rectangle.prototype.constructor=Rectangle;function Layout(b,a){this.maxWidth=b;this.maxHeight=a;this.padding=10;this.flowLeft=function(e){var d=0,g=0;for(var c in e){var f=e[c];if(f instanceof Drawable){f.position(d,g);d+=f.width()+this.padding;if(d+f.width()>=this.maxWidth){g+=f.height()+this.padding;d=0}}}}};